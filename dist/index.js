"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("node-fetch"),e=require("passport-oauth2"),r=require("pkginfo");function a(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var i=a(t),o=a(e),n=a(r);class s extends o.default{constructor(t,e){super(Object.assign(Object.assign({},t),{authorizationURL:"https://id.twitch.tv/oauth2/authorize",tokenURL:"https://id.twitch.tv/oauth2/token"}),e),this.name="twitch",this.clientID=t.clientID,this._oauth2.setAuthMethod("Bearer"),this._oauth2.useAuthorizationHeaderforGET(!0)}userProfile(t,e){return i.default("https://api.twitch.tv/helix/users",{method:"GET",headers:{"Client-ID":this.clientID,Accept:"application/vnd.twitchtv.v5+json",Authorization:"Bearer "+t}}).then(t=>{if(t.ok)return t.json();throw new o.default.InternalOAuthError("failed to fetch user profile",t)}).then(t=>{const r=t.data[0];return r.provider="twitch",r.display_name&&(r.displayName=r.display_name,delete r.display_name),e(null,r)}).catch(t=>e(t,null))}authenticate(t,e){super.authenticate(t,e)}authorizationParams(t){return{force_verify:"boolean"==typeof t.forceVerify&&t.forceVerify}}}n.default(module,"version");const u=s;exports.OAuth2Strategy=u,exports.Strategy=s;
//# sourceMappingURL=index.js.map
